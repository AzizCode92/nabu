<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nabu-asr: neuralnetworks.trainers.cross_enthropytrainer.CrossEnthropyTrainer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Nabu-asr
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceneuralnetworks.html">neuralnetworks</a></li><li class="navelem"><b>trainers</b></li><li class="navelem"><b>cross_enthropytrainer</b></li><li class="navelem"><a class="el" href="classneuralnetworks_1_1trainers_1_1cross__enthropytrainer_1_1CrossEnthropyTrainer.html">CrossEnthropyTrainer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classneuralnetworks_1_1trainers_1_1cross__enthropytrainer_1_1CrossEnthropyTrainer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">neuralnetworks.trainers.cross_enthropytrainer.CrossEnthropyTrainer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A trainer that minimises the cross-enthropy loss, the output sequences must be of the same length as the input sequences.  
 <a href="classneuralnetworks_1_1trainers_1_1cross__enthropytrainer_1_1CrossEnthropyTrainer.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for neuralnetworks.trainers.cross_enthropytrainer.CrossEnthropyTrainer:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classneuralnetworks_1_1trainers_1_1cross__enthropytrainer_1_1CrossEnthropyTrainer.png" usemap="#neuralnetworks.trainers.cross_5Fenthropytrainer.CrossEnthropyTrainer_map" alt=""/>
  <map id="neuralnetworks.trainers.cross_5Fenthropytrainer.CrossEnthropyTrainer_map" name="neuralnetworks.trainers.cross_enthropytrainer.CrossEnthropyTrainer_map">
<area href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html" title="General class outlining the training environment of a classifier. " alt="neuralnetworks.trainers.trainer.Trainer" shape="rect" coords="0,56,403,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab2eb7dc6f5d8407e2b6c814f17c2384c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnetworks_1_1trainers_1_1cross__enthropytrainer_1_1CrossEnthropyTrainer.html#ab2eb7dc6f5d8407e2b6c814f17c2384c">compute_loss</a> (self, targets, logits, logit_seq_length, target_seq_length)</td></tr>
<tr class="memdesc:ab2eb7dc6f5d8407e2b6c814f17c2384c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the loss.  <a href="#ab2eb7dc6f5d8407e2b6c814f17c2384c">More...</a><br /></td></tr>
<tr class="separator:ab2eb7dc6f5d8407e2b6c814f17c2384c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8da4aca9131c4aa2290816651cd59b08"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnetworks_1_1trainers_1_1cross__enthropytrainer_1_1CrossEnthropyTrainer.html#a8da4aca9131c4aa2290816651cd59b08">validation</a> (self, logits, logit_seq_length)</td></tr>
<tr class="memdesc:a8da4aca9131c4aa2290816651cd59b08"><td class="mdescLeft">&#160;</td><td class="mdescRight">apply a softmax to the logits so the cross-enthropy can be computed  <a href="#a8da4aca9131c4aa2290816651cd59b08">More...</a><br /></td></tr>
<tr class="separator:a8da4aca9131c4aa2290816651cd59b08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f3760b2e054f22b65ad22e81fc2e8e4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnetworks_1_1trainers_1_1cross__enthropytrainer_1_1CrossEnthropyTrainer.html#a1f3760b2e054f22b65ad22e81fc2e8e4">validation_metric</a> (self, outputs, targets)</td></tr>
<tr class="memdesc:a1f3760b2e054f22b65ad22e81fc2e8e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">the cross-enthropy  <a href="#a1f3760b2e054f22b65ad22e81fc2e8e4">More...</a><br /></td></tr>
<tr class="separator:a1f3760b2e054f22b65ad22e81fc2e8e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html">neuralnetworks.trainers.trainer.Trainer</a></td></tr>
<tr class="memitem:a36d78911742e61e9bb2159c06f1ea711 inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html#a36d78911742e61e9bb2159c06f1ea711">__init__</a> (self, conf, decoder_conf, classifier, input_dim, max_input_length, max_target_length, dispenser, val_reader=None, val_targets=None, expdir=None, server=None, cluster=None, task_index=0)</td></tr>
<tr class="memdesc:a36d78911742e61e9bb2159c06f1ea711 inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="mdescLeft">&#160;</td><td class="mdescRight">NnetTrainer constructor, creates the training graph.  <a href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html#a36d78911742e61e9bb2159c06f1ea711">More...</a><br /></td></tr>
<tr class="separator:a36d78911742e61e9bb2159c06f1ea711 inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d84d6e578d110b8b935a0627176478a inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html#a0d84d6e578d110b8b935a0627176478a">compute_loss</a> (self, targets, logits, logit_seq_length, target_seq_length)</td></tr>
<tr class="memdesc:a0d84d6e578d110b8b935a0627176478a inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the loss.  <a href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html#a0d84d6e578d110b8b935a0627176478a">More...</a><br /></td></tr>
<tr class="separator:a0d84d6e578d110b8b935a0627176478a inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa20b4f1f7868665ad9ce0f08335ade47 inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html#aa20b4f1f7868665ad9ce0f08335ade47">validation</a> (self, logits, logit_seq_length)</td></tr>
<tr class="memdesc:aa20b4f1f7868665ad9ce0f08335ade47 inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute the outputs that will be used for validation  <a href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html#aa20b4f1f7868665ad9ce0f08335ade47">More...</a><br /></td></tr>
<tr class="separator:aa20b4f1f7868665ad9ce0f08335ade47 inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d269bf6176932bf4e861138ba727174 inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html#a4d269bf6176932bf4e861138ba727174">validation_metric</a> (self, outputs, targets)</td></tr>
<tr class="memdesc:a4d269bf6176932bf4e861138ba727174 inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute the metric that will be used for validation  <a href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html#a4d269bf6176932bf4e861138ba727174">More...</a><br /></td></tr>
<tr class="separator:a4d269bf6176932bf4e861138ba727174 inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4a71d47532adfc8f3b5a37fb9d1e90c inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="ae4a71d47532adfc8f3b5a37fb9d1e90c"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html#ae4a71d47532adfc8f3b5a37fb9d1e90c">train</a> (self)</td></tr>
<tr class="memdesc:ae4a71d47532adfc8f3b5a37fb9d1e90c inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="mdescLeft">&#160;</td><td class="mdescRight">train the model <br /></td></tr>
<tr class="separator:ae4a71d47532adfc8f3b5a37fb9d1e90c inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61c5733fd4803c995800c3d396ba9a5e inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html#a61c5733fd4803c995800c3d396ba9a5e">update</a> (self, inputs, targets, sess)</td></tr>
<tr class="memdesc:a61c5733fd4803c995800c3d396ba9a5e inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="mdescLeft">&#160;</td><td class="mdescRight">update the neural model with a batch or training data  <a href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html#a61c5733fd4803c995800c3d396ba9a5e">More...</a><br /></td></tr>
<tr class="separator:a61c5733fd4803c995800c3d396ba9a5e inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1654670a59150e51ae6922c5e834368f inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a1654670a59150e51ae6922c5e834368f"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>validate</b> (self, sess)</td></tr>
<tr class="separator:a1654670a59150e51ae6922c5e834368f inherit pub_methods_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer.html">neuralnetworks.trainers.trainer.Trainer</a></td></tr>
<tr class="memitem:af05a2a1bcf99beb8a0be6bbd3124e2ab inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="af05a2a1bcf99beb8a0be6bbd3124e2ab"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>conf</b></td></tr>
<tr class="separator:af05a2a1bcf99beb8a0be6bbd3124e2ab inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd446708ce133eabd5cb1a1ad3e53bd0 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="acd446708ce133eabd5cb1a1ad3e53bd0"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>dispenser</b></td></tr>
<tr class="separator:acd446708ce133eabd5cb1a1ad3e53bd0 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe07565001b27d3adf1b53e4e2ad6c09 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="afe07565001b27d3adf1b53e4e2ad6c09"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>max_input_length</b></td></tr>
<tr class="separator:afe07565001b27d3adf1b53e4e2ad6c09 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae634b61ee81fa46fb8091ab1b71dc12b inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="ae634b61ee81fa46fb8091ab1b71dc12b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>max_target_length</b></td></tr>
<tr class="separator:ae634b61ee81fa46fb8091ab1b71dc12b inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade0004a50bd194a66923e6647794df42 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="ade0004a50bd194a66923e6647794df42"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>num_steps</b></td></tr>
<tr class="separator:ade0004a50bd194a66923e6647794df42 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61b8ef6593f035d13b87a21193142af8 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a61b8ef6593f035d13b87a21193142af8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>val_reader</b></td></tr>
<tr class="separator:a61b8ef6593f035d13b87a21193142af8 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82f806c874a1be130e3b65369b289ae0 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a82f806c874a1be130e3b65369b289ae0"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>val_targets</b></td></tr>
<tr class="separator:a82f806c874a1be130e3b65369b289ae0 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9c2ac7ffc552354906c48ba60246b79 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="ad9c2ac7ffc552354906c48ba60246b79"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>logdir</b></td></tr>
<tr class="separator:ad9c2ac7ffc552354906c48ba60246b79 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41bb5c84c04f057c347d02e6701fd390 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a41bb5c84c04f057c347d02e6701fd390"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>server</b></td></tr>
<tr class="separator:a41bb5c84c04f057c347d02e6701fd390 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc8ad7f250305274e38a3f4e7ea2cac inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a1cc8ad7f250305274e38a3f4e7ea2cac"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>cluster</b></td></tr>
<tr class="separator:a1cc8ad7f250305274e38a3f4e7ea2cac inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeafea35736e3cab3d2e1abe2277fbcea inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="aeafea35736e3cab3d2e1abe2277fbcea"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>graph</b></td></tr>
<tr class="separator:aeafea35736e3cab3d2e1abe2277fbcea inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87619872612aef5c9590b1c5655d6e4a inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a87619872612aef5c9590b1c5655d6e4a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>inputs</b></td></tr>
<tr class="separator:a87619872612aef5c9590b1c5655d6e4a inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf439e4b26b0d06f77338cc487f401e4 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="adf439e4b26b0d06f77338cc487f401e4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>targets</b></td></tr>
<tr class="separator:adf439e4b26b0d06f77338cc487f401e4 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d52666352ab7d8cdf7bc2af37c4817d inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a7d52666352ab7d8cdf7bc2af37c4817d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>input_seq_length</b></td></tr>
<tr class="separator:a7d52666352ab7d8cdf7bc2af37c4817d inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af88202c293fc9f9c2c5b6f8f44bcd876 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="af88202c293fc9f9c2c5b6f8f44bcd876"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>target_seq_length</b></td></tr>
<tr class="separator:af88202c293fc9f9c2c5b6f8f44bcd876 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a9e3e6499a3bcf9b103ee676cf89172 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a3a9e3e6499a3bcf9b103ee676cf89172"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>pos_in</b></td></tr>
<tr class="separator:a3a9e3e6499a3bcf9b103ee676cf89172 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeda31b4391b6c97764a8c1fb77da9966 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="aeda31b4391b6c97764a8c1fb77da9966"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>val_loss_in</b></td></tr>
<tr class="separator:aeda31b4391b6c97764a8c1fb77da9966 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20ee4303723166980b043d0d75066f73 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a20ee4303723166980b043d0d75066f73"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>modelsaver</b></td></tr>
<tr class="separator:a20ee4303723166980b043d0d75066f73 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a631313fc1f07e840d03ee35eb7d3964d inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a631313fc1f07e840d03ee35eb7d3964d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>decoder</b></td></tr>
<tr class="separator:a631313fc1f07e840d03ee35eb7d3964d inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a458c1bd76f03544f7ff8a40d37579904 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a458c1bd76f03544f7ff8a40d37579904"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>done</b></td></tr>
<tr class="separator:a458c1bd76f03544f7ff8a40d37579904 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95e0845b836285673df88ecbefc53eaf inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a95e0845b836285673df88ecbefc53eaf"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>global_step</b></td></tr>
<tr class="separator:a95e0845b836285673df88ecbefc53eaf inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ec91d53ed869caef136f825e9c0c550 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a7ec91d53ed869caef136f825e9c0c550"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>reading</b></td></tr>
<tr class="separator:a7ec91d53ed869caef136f825e9c0c550 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa76daa64401d38a9bf30a40053fe99d8 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="aa76daa64401d38a9bf30a40053fe99d8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>pos</b></td></tr>
<tr class="separator:aa76daa64401d38a9bf30a40053fe99d8 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fbb15e623606c61e3ea4f3c3c9e006e inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a3fbb15e623606c61e3ea4f3c3c9e006e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>val_loss</b></td></tr>
<tr class="separator:a3fbb15e623606c61e3ea4f3c3c9e006e inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5e9d7bb63665a73cd7637f411de1f8 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="aec5e9d7bb63665a73cd7637f411de1f8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>validated_step</b></td></tr>
<tr class="separator:aec5e9d7bb63665a73cd7637f411de1f8 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8909ba231d4ac16d03876a3436282eed inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a8909ba231d4ac16d03876a3436282eed"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>block_reader</b></td></tr>
<tr class="separator:a8909ba231d4ac16d03876a3436282eed inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eb87bc5d4081bf7d260ddf01a7cf6ab inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a4eb87bc5d4081bf7d260ddf01a7cf6ab"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>release_reader</b></td></tr>
<tr class="separator:a4eb87bc5d4081bf7d260ddf01a7cf6ab inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62f9c2c4ec789a9c683a6811225ab065 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a62f9c2c4ec789a9c683a6811225ab065"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>set_pos</b></td></tr>
<tr class="separator:a62f9c2c4ec789a9c683a6811225ab065 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbe91363a1e1dca70c979e0a84d00349 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="abbe91363a1e1dca70c979e0a84d00349"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>set_val_step</b></td></tr>
<tr class="separator:abbe91363a1e1dca70c979e0a84d00349 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e2c2699f6581abc2101d658459da9b1 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a4e2c2699f6581abc2101d658459da9b1"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>set_val_loss</b></td></tr>
<tr class="separator:a4e2c2699f6581abc2101d658459da9b1 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1432ea2e2cef5b86021a9c0d1ce537c6 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a1432ea2e2cef5b86021a9c0d1ce537c6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>halve_learningrate_op</b></td></tr>
<tr class="separator:a1432ea2e2cef5b86021a9c0d1ce537c6 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afab0fdf5bf7edcba32a08f7e9698f532 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="afab0fdf5bf7edcba32a08f7e9698f532"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>learning_rate</b></td></tr>
<tr class="separator:afab0fdf5bf7edcba32a08f7e9698f532 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace93c4e001f9110b18baf25be60a0e4a inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="ace93c4e001f9110b18baf25be60a0e4a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>loss</b></td></tr>
<tr class="separator:ace93c4e001f9110b18baf25be60a0e4a inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dc02a18c35ff8cb24d2837a7c2a1193 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a6dc02a18c35ff8cb24d2837a7c2a1193"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>update_op</b></td></tr>
<tr class="separator:a6dc02a18c35ff8cb24d2837a7c2a1193 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14e5ce107c79c387f351167fb4becdbb inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a14e5ce107c79c387f351167fb4becdbb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>init_op</b></td></tr>
<tr class="separator:a14e5ce107c79c387f351167fb4becdbb inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8de8e24dfc5de87a0eb3d88d56f5bb5b inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a8de8e24dfc5de87a0eb3d88d56f5bb5b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>init_token_op</b></td></tr>
<tr class="separator:a8de8e24dfc5de87a0eb3d88d56f5bb5b inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a519782e861dae50d5072172ffb3c223e inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a519782e861dae50d5072172ffb3c223e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>chief_queue_runner</b></td></tr>
<tr class="separator:a519782e861dae50d5072172ffb3c223e inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0ca74b8a77a2d4e4736e94f2376a822 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="ab0ca74b8a77a2d4e4736e94f2376a822"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>trainsaver</b></td></tr>
<tr class="separator:ab0ca74b8a77a2d4e4736e94f2376a822 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2334c306eacd5810c411d1b77a793fc8 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memItemLeft" align="right" valign="top"><a id="a2334c306eacd5810c411d1b77a793fc8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>supervisor</b></td></tr>
<tr class="separator:a2334c306eacd5810c411d1b77a793fc8 inherit pub_attribs_classneuralnetworks_1_1trainers_1_1trainer_1_1Trainer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A trainer that minimises the cross-enthropy loss, the output sequences must be of the same length as the input sequences. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ab2eb7dc6f5d8407e2b6c814f17c2384c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2eb7dc6f5d8407e2b6c814f17c2384c">&sect;&nbsp;</a></span>compute_loss()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def neuralnetworks.trainers.cross_enthropytrainer.CrossEnthropyTrainer.compute_loss </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>targets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>logits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>logit_seq_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_seq_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the loss. </p>
<p>Creates the operation to compute the cross-enthropy loss for every input frame (if you want to have a different loss function, overwrite this method)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">targets</td><td>a list that contains a Bx1 tensor containing the targets for eacht time step where B is the batch size </td></tr>
    <tr><td class="paramname">logits</td><td>a list that contains a BxO tensor containing the output logits for eacht time step where O is the output dimension </td></tr>
    <tr><td class="paramname">logit_seq_length</td><td>the length of all the input sequences as a vector </td></tr>
    <tr><td class="paramname">target_seq_length</td><td>the length of all the target sequences as a </td></tr>
    <tr><td class="paramname">vector</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a scalar value containing the loss </dd></dl>

</div>
</div>
<a id="a8da4aca9131c4aa2290816651cd59b08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8da4aca9131c4aa2290816651cd59b08">&sect;&nbsp;</a></span>validation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def neuralnetworks.trainers.cross_enthropytrainer.CrossEnthropyTrainer.validation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>logits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>logit_seq_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>apply a softmax to the logits so the cross-enthropy can be computed </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">logits</td><td>a [batch_size, max_input_length, dim] tensor containing the </td></tr>
    <tr><td class="paramname">logits</td><td></td></tr>
    <tr><td class="paramname">logit_seq_length</td><td>the length of all the input sequences as a vector</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a tensor with the same shape as logits with the label probabilities </dd></dl>

</div>
</div>
<a id="a1f3760b2e054f22b65ad22e81fc2e8e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f3760b2e054f22b65ad22e81fc2e8e4">&sect;&nbsp;</a></span>validation_metric()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def neuralnetworks.trainers.cross_enthropytrainer.CrossEnthropyTrainer.validation_metric </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>outputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>targets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the cross-enthropy </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">outputs</td><td>the validation output, which is a matrix containing the label probabilities of size [batch_size, max_input_length, dim]. </td></tr>
    <tr><td class="paramname">targets</td><td>a list containing the ground truth target labels</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a numpy array containing the loss of all utterances </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="cross__enthropytrainer_8py.html">cross_enthropytrainer.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
